<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Create an intelligent search app using Watson Discovery UI components - IBM Code Learning Path 日本語サイト</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Create an intelligent search app using Watson Discovery UI components";
    var mkdocs_page_input_path = "Code-Tutorials/create-an-intelligent-search-app-using-watson-discovery-ui-components/index_en.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> IBM Code Learning Path 日本語サイト</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="" href="../../../index.md">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Learning Paths</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="#">Watson Discoveryを始める</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../Code-Learning-Paths/get-started-watson-discovery/">Index</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../Code-Articles/introduction-watson-discovery/">Introduction Watson Discovery</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../Code-Patterns/create-an-app-to-perform-intelligent-searches-on-data/">Create an app to perform intelligent searches on data</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../Code-Patterns/enhance-customer-helpdesk-with-smart-document-understanding-using-search-skill/">Enhance customer helpdesk with smart document understanding using search skill</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../">Create an intelligent search app using watson discovery ui components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../Code-Learning-Paths/get-started-watson-discovery/summary/">Summary</a>
                </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">IBM Code Learning Path 日本語サイト</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
    
    <li>Create an intelligent search app using Watson Discovery UI components</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <p>IBM Watson Discovery has a powerful analytics engine that provides cognitive enrichments and insights into your data. This tutorial showcases a new feature of the Discovery service -- Watson Discovery UI components. These components are tied directly to your Discovery projects and can easily be plugged into your search application. The components are self-contained and don't require any additional API calls to the Discovery service to retrieve data.</p>
<h2 id="learning-objectives">Learning objectives</h2>
<p>In this tutorial, learn how to navigate the Watson Discovery service to load and manage your data. This includes enhancing the enrichments that are applied to your data and building a custom panel to query and visualize your data. Then, learn how to replicate the search panel in your own application, which is built using <a href="https://reactjs.org/">React</a>, <a href="https://expressjs.com/">Express</a>, and the Watson Discovery UI components.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>To follow along with this tutorial, you must have an <a href="https://cloud.ibm.com/login?cm_sp=ibmdev-_-developer-tutorials-_-cloudreg">IBM Cloud account</a> where you can provision an instance of Watson Discovery.</p>
<h2 id="estimated-time">Estimated time</h2>
<p>It should take you approximately 60 minutes to complete the tutorial.</p>
<h2 id="steps">Steps</h2>
<ol>
<li><a href="#launch-watson-discovery">Launch Watson Discovery</a></li>
<li><a href="#create-a-new-project">Create a new project</a></li>
<li><a href="#upload-data-files-into-collection">Upload data files into collection</a></li>
<li><a href="#enrich-the-data">Enrich the data</a></li>
<li><a href="#add-enrichments-to-search-panel">Add enrichments to search panel</a></li>
<li><a href="#create-your-ui-app">Create your UI app</a></li>
<li><a href="#key-files-and-concepts">Key files and concepts</a></li>
</ol>
<h3 id="launch-watson-discovery">Launch Watson Discovery</h3>
<p>If you do not have an IBM Cloud account, register for a <a href="https://cloud.ibm.com/registration?cm_sp=ibmdev-_-developer-tutorials-_-cloudreg">free trial account</a>.</p>
<ol>
<li>
<p>Using your IBM Cloud account, create a Watson Discovery instance from the <a href="https://cloud.ibm.com/catalog/services/discovery?cm_sp=ibmdev-_-developer-tutorials-_-cloudreg">resource catalog</a>, and select the <strong>Plus</strong> plan.</p>
<p><strong>Note:</strong> The first instance of the Plus plan for IBM Watson Discovery comes with a free 30-day trial. If you no longer require your Plus instance for Watson Discovery after going through this exercise, you can delete it.</p>
<p><img alt="launch-disco" src="../images/launch-disco.png" /></p>
</li>
<li>
<p>From the Discovery instance page, click <strong>Launch Watson Discovery</strong>.</p>
</li>
</ol>
<h3 id="create-a-new-project">Create a new project</h3>
<ol>
<li>
<p>The landing page for the Discovery service shows you a list of current projects. Click <strong>New project</strong>.</p>
<p><img alt="project-page" src="../images/project-page.png" /></p>
</li>
<li>
<p>For this tutorial, you are creating a <em>Document Retrival</em> type of project. Select that Project type, give the project a unique name, then click <strong>Next</strong>.</p>
<p><img alt="project-create" src="../images/project-create.png" /></p>
</li>
</ol>
<h3 id="upload-data-files-into-collection">Upload data files into collection</h3>
<ol>
<li>
<p>The next step is telling Discovery where your data will come from. In this example, you upload the data from JSON data files, so click <strong>Upload data</strong>, and then click <strong>Next</strong>.</p>
<p><img alt="project-data-source" src="../images/project-data-source.png" /></p>
</li>
<li>
<p>Enter a <strong>Collection name</strong>, then click <strong>Next</strong>.</p>
<p><img alt="collection-name" src="../images/collection-name.png" /></p>
<p><strong>Note:</strong> Projects can contain multiple collections. When Discovery performs a search, it is at the project level, and by default, includes all of the collections within that project. </p>
</li>
<li>
<p>From the upload panel, click the <strong>Drag and drop files here or upload</strong> text. This opens a file window where you can select what files to upload.</p>
<p>For this tutorial, you use 999 reviews that were submitted by AirBnB customers in Austin, TX. Each review has a title, the AirBnB location and host name, the reviewers name, a rating score, and the text of the review.</p>
</li>
<li>
<p>Download the <a href="../static/AirBnb.zip">AirBnB reviews file</a> to your system, unzip it, then select the 999 JSON files to upload.</p>
<p><img alt="collection-load-data" src="../images/collection-load-data.png" /></p>
</li>
<li>
<p>When you complete the action, click <strong>Finish</strong>.</p>
</li>
</ol>
<p>Your data starts to upload. Discovery provides alerts to tell you when the upload is complete.</p>
<h3 id="enrich-the-data">Enrich the data</h3>
<ol>
<li>
<p>Click <strong>Manage collections</strong> on the left to show all of the collections associated with your project. </p>
<p><strong>Note:</strong> To change which project you are currently working on, you can click My projects at the top of the page.</p>
<p><img alt="project-collections-page" src="../images/project-collections-page.png" /></p>
<p>When you click the collection that you just created, you see that all 999 reviews have been loaded.</p>
<p><img alt="collection-panel" src="../images/collection-panel.png" /></p>
</li>
<li>
<p>Click <strong>Enrichments</strong>. As you can see, the default enrichments are <em>Part of speech</em> and <em>Entities v2</em>. For this review data, you are also going to include <em>Keywords</em> and <em>Sentiment of Document</em>.</p>
<p><img alt="collection-enrichments" src="../images/collection-enrichments.png" /></p>
</li>
<li>
<p>For each of these new enrichments, click <strong>Fields to enrich</strong>, and select the <strong>text</strong> field.</p>
</li>
</ol>
<h3 id="add-enrichments-to-search-panel">Add enrichments to search panel</h3>
<p>Now that you have some new enrichments, add them to your default search panel.</p>
<ol>
<li>
<p>Click <strong>Improve and customize</strong> on the left to display the search panel associated with your collection.</p>
<p><img alt="project-custom-display" src="../images/project-custom-display.png" /></p>
</li>
<li>
<p>To customize the display, you add all of the facets. To start, click the drop-down menu for <strong>Customize display</strong> located on the right side of the panel.</p>
</li>
<li>
<p>Click <strong>Facets</strong>, <strong>New facet</strong>, then <strong>From existing fields in collection</strong>.</p>
</li>
<li>
<p>For your <strong>Keyword</strong> facet, select the field <strong>enriched_text.keywords.mentions.text</strong>. This provides the most common keywords that are found in the data.</p>
<p><img alt="facet-keyword-mentions" src="../images/facet-keyword-mentions.png" /></p>
</li>
<li>
<p>Provide a meaningful label for the UI component, then click <strong>Apply</strong>.</p>
<p><img alt="facet-top-keywords" src="../images/facet-top-keywords.png" /></p>
</li>
<li>
<p>Repeat the process for the <strong>Sentiment</strong> facet, but use the field <strong>enriched_text.sentiment.score</strong>.</p>
<p><img alt="facet-sentiment-score" src="../images/facet-sentiment-score.png" /></p>
</li>
<li>
<p>When complete, you see how the facets are now a part of the search panel.</p>
<p><img alt="facet-final" src="../images/facet-final.png" /></p>
</li>
</ol>
<p>If you enter a search string, you see the results displayed as well as new facet values that reflect the subset of reviews that match the search.</p>
<p><img alt="facet-search" src="../images/facet-search.png" /></p>
<p>If you click <strong>View passage in document</strong> for any of the reviews, you drill down into the review data. If you click the <strong>JSON</strong> tab, you can see the actual result that is returned by Discovery.</p>
<p><img alt="facet-passage-json" src="../images/facet-passage-json.png" /></p>
<p>Notice that in this case, the search found a match with the <code>title</code> of the review. The actual review is shown in the <code>text</code> field.</p>
<h3 id="create-your-ui-app">Create your UI app</h3>
<p>Now that your search panel has been enhanced to show all of the interesting facets of the data, you can build an application that displays that same panel. For this task, you use the <a href="https://github.com/watson-developer-cloud/discovery-components">starter kit</a> provided by Watson Discovery.</p>
<p>The starter kit provides multiple ways to develop your app, but in this tutorial, you'll choose the manual method to integrate your Discovery collection with their example app.</p>
<h4 id="clone-the-repo">Clone the repo</h4>
<ol>
<li>To get started, you first need to clone the GitHub repo to your local system.</li>
</ol>
<pre><code class="language-bash">$ git clone https://github.com/watson-developer-cloud/discovery-components.git
$ cd journeys/discovery-components
</code></pre>
<h4 id="gather-your-credentials">Gather your credentials</h4>
<ol>
<li>
<p>Return to IBM Cloud and your Watson Discovery launch panel to get your API key and service URL.</p>
<p><img alt="launch-disco" src="../images/launch-disco.png" /></p>
</li>
<li>
<p>You also need your project ID, which you can get from the Watson Discovery Integrate and deploy panel for your project.</p>
<p><img alt="project-id" src="../images/project-id.png" /></p>
</li>
</ol>
<h4 id="add-credentials-to-environment-files">Add credentials to environment files</h4>
<ol>
<li>
<p>From the root directory of your local repo, run the following commands to create the environment files. Note that the files must be created in the examples/discovery-search-app directory.</p>
<p><code>bash
$ cd examples/discovery-search-app
$ cp .env .env.local
$ echo "DISCOVERY_AUTH_TYPE=iam
DISCOVERY_URL=&lt;replace with discovery URL&gt;
DISCOVERY_APIKEY=&lt;replace with API key&gt;" &gt; ibm-credentials.env</code></p>
</li>
<li>
<p>Update the ibm-credentials.env file with your Discovery credentials, and update the .env.local file with your project ID.</p>
</li>
</ol>
<h4 id="build-and-run-the-app">Build and run the app</h4>
<p>Now, you can return to your project root directory to build and start your app.</p>
<p>The following commands require that the <a href="https://yarnpkg.com/">Yarn</a> package manager be installed on your local system.</p>
<pre><code class="language-bash">$ cd ../..
$ yarn workspace @ibm-watson/discovery-react-components run build
$ yarn workspace discovery-search-app run start
</code></pre>
<p>After it starts, a browser opens with the base search panel displayed. Enter a search string to view the list of matching reviews.</p>
<p><img alt="ui-app-screen" src="../images/ui-app-screen.png" /></p>
<p>Notice that all of the facets that you added in the Discovery tool show up here.</p>
<h2 id="key-files-and-concepts">Key files and concepts</h2>
<p>The Discovery UI app consists of a React client and Express server. To explore the code, navigate to the examples/discovery-search-app subdirectory. There, you find the React code in the src directory and the Express code in the server.js file.</p>
<p>The following code shows the Discovery UI React components being imported.</p>
<pre><code class="language-js">// examples/disovery-search-app/src/App.js

import {
  DiscoverySearch,
  SearchContext,
  SearchApi,
  SearchInput,
  SearchResults,
  SearchFacets,
  ResultsPagination,
  DocumentPreview,
  CIDocument,
  canRenderCIDocument
} from '@ibm-watson/discovery-react-components';

...

    &lt;DiscoverySearch searchClient={searchClient} projectId={projectId}&gt;
      &lt;AppView /&gt;
    &lt;/DiscoverySearch&gt;

</code></pre>
<p>In the previous list, the main component is <code>DiscoverySearch</code>. It requires that the Discovery client and project ID be passed in as parameters. This allows all of the details of each component to be self-contained, which means no additional programming is required to use them.</p>
<p><strong>Note:</strong> Before these UI components were developed, you needed to create your own UI components and tie them to your Discovery data using the Watson Discovery API. While the provided components give you a good starting point to handle the most common UI components found in a typical Discovery search application, you must still use the old approach for any advanced custom components (for example, a line graph chart to show sentiment score trends over time).</p>
<p>For the client to have access to the Discovery service instance, you either must fetch that from the server or instantiate your Discovery service on the client side. In the example app, this is done using a proxy, which is initiated by the client making a call to instantiate a Discovery instance.</p>
<pre><code class="language-js">// examples/disovery-search-app/src/App.js

const authenticator = new NoAuthAuthenticator();
const searchClient = new DiscoveryV2({
  url: `${window.location.href}api`,
  version: '2019-01-01',
  authenticator
});
</code></pre>
<p>However, the URL in this case is a route to the server (note that <code>api</code> is appended to the route). The server code uses a proxy to handle this route.</p>
<pre><code class="language-js">// examples/disovery-search-app/server.js

const express = require('express');
const app = express();
const proxy = require('./src/setupProxy.js');

...
proxy(app);
</code></pre>
<p>When the proxy is called with this route, it does the work of using the credentials file to get and return an authorization token from the Discovery service.</p>
<pre><code class="language-js">// examples/disovery-search-app/src/setupProxy.js

const addAuthorization = async (req, _res, next) =&gt; {
  const authenticator = getAuthenticatorFromEnvironment('discovery');
  try {
    const accessToken = await authenticator.tokenManager.getToken();
    req.headers.authorization = `Bearer ${accessToken}`;
  } catch (e) {
    console.error(e);
  }
  return next();
};

...

app.use(
  '/api',
  addAuthorization,
  proxy({
    ...
  })
);
</code></pre>
<p>From the client-side perspective, the call to instantiate a Discovery service instance works because the authenticator is substituted with an actual token. This also means that the client doesn't have to worry about embedding the credentials in the client code or making them visible in the browser console.</p>
<h2 id="summary">Summary</h2>
<p>In this tutorial, you learned how to navigate the Watson Discovery tool to create a project and upload data into a collection. You then learned how to enrich the data and build a custom search panel to query and visualize the data.</p>
<p><img alt="final-disco-panel" src="../images/final-disco-panel.png" /></p>
<p>Finally, you replicated the same search panel in a custom application by using the Watson Discovery UI Components.</p>
<p><img alt="final-app-panel" src="../images/final-app-panel.png" /></p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme_extra.js" defer></script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
